!function(){var n,t,e,o,i;window.GFPPCPSettings=null,n=jQuery,t=gform_ppcp_pluginsettings_strings,e=t.prefixes,o=t.is_legacy_markup,i=t.loader_text,window.onboardedCallback=function(n,t){if(showOnBoardingLoader(),!window.gfppcp_onboarding){window.gfppcp_onboarding=!0;var o=document.querySelectorAll('[name="'.concat(e.input,'environment"]:checked'))[0].value;fetch(ajaxurl+"?action=gfppcp_onboarding&nonce="+gform_ppcp_pluginsettings_strings.onboarding_nonce+"&environment="+o,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({authCode:n,sharedId:t})}).then((function(n){return n.ok||alert(gform_ppcp_pluginsettings_strings.onboarding_error),n.json()})).then((function(n){n.success||alert(n.data.message)}))}},window.showOnBoardingLoader=function(){try{gform.instances=gform.instances||{},gform.instances.loaders=gform.instances.loaders||{},gform.instances.loaders.ppcpSettingsLoader=new gform.components.admin.html.elements.Loader({id:"gform-ppcp-loader",position:"sticky",renderOnInit:!1,target:"#wpbody-content",text:i}),gform.instances.loaders.ppcpSettingsLoader.init()}catch(e){console.warn(e),document.querySelectorAll(".gform-settings-field").forEach((function(n){n.style.display="none"}));var n=document.createElement("h3");n.innerText=i;var t=document.querySelector(".gform-settings-description");t.parentNode.insertBefore(n,t)}},window.GFPPCPSettings=function(){var t=this;t.environment=n('[name="'.concat(e.input,'environment"]:checked')).val(),t.saveContainer="true"===o?n("#gform-settings-save").closest("tr"):n("#tab_gravityformsppcp").find(".gform-settings-save-container"),t.button=n(".gform_ppcp_connect_button"),t.init=function(){t.initEnvironment(),t.bindEnvironmentChange(),t.bindDisconnect(),t.maybeDisplayRetryMessage()},t.initEnvironment=function(){""!==t.environment&&void 0!==t.environment||(t.environment="live",n("#environment0").prop("checked",!0)),t.environmentChange(t.environment)},t.bindEnvironmentChange=function(){t.environmentChange(t.environment),n('#tab_gravityformsppcp input[name="'.concat(e.input,'environment"]')).on("change",(function(){t.environment=n(this).val(),t.environmentChange(t.environment),t.toggleSettingsSave()}))},t.toggleSettingsSave=function(){n("#".concat(e.field).concat(t.environment,"_auth_button .gform_ppcp_disconnect_button")).length?t.saveContainer.fadeIn():t.saveContainer.fadeOut()},t.environmentChange=function(t){var i="live"===t?"sandbox":"live";n("#".concat(e.field).concat(i,"_auth_button, #").concat(e.field).concat(i,"_account_status, #").concat(e.field).concat(t,"_account_status")).hide(),n("#".concat(e.field).concat(t,"_auth_button")).show();var a=n("#".concat(e.field).concat(t,"_account_status")),c="true"===o?a.find("td"):a.find("p");c.length&&""!==c.html().trim()&&a.show()},t.bindDisconnect=function(){n(".gform_ppcp_disconnect_button").on("click",(function(e){e.preventDefault();var o=gform_ppcp_pluginsettings_strings.disconnect,i=n(this);if(!confirm(o.site))return!1;i.attr("disabled","disabled"),n.ajax({async:!1,url:ajaxurl,dataType:"json",method:"POST",data:{action:"gfppcp_disconnect",environment:t.environment,nonce:gform_ppcp_pluginsettings_strings.disconnect_nonce},success:function(n){n.success?window.location.reload():(alert(n.data.message),i.removeAttr("disabled"))}})}))},t.maybeDisplayRetryMessage=function(){var n=gform_ppcp_pluginsettings_strings.retry_auth;n&&alert(n)},t.init()},n(document).ready(GFPPCPSettings)}();
//# sourceMappingURL=plugin_settings.js.map